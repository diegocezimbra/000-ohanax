<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Arquitetura - Smart Noter</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="/shared/nav-header.js" defer></script>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <h1><i class="fas fa-microphone"></i> Smart Noter</h1>
            <span class="version">v1.0</span>
        </div>
        <div class="header-right">
            <a href="index.html" class="header-link"><i class="fas fa-home"></i> Início</a>
        </div>
    </header>

    <nav class="sidebar">
        <div class="sidebar-section">
            <div class="sidebar-title">Início</div>
            <ul class="sidebar-nav">
                <li><a href="index.html"><i class="fas fa-home"></i> Visão Geral</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Fundamentos</div>
            <ul class="sidebar-nav">
                <li><a href="design-system.html"><i class="fas fa-palette"></i> Design System</a></li>
                <li><a href="arquitetura.html"><i class="fas fa-sitemap"></i> Arquitetura</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Tecnologia</div>
            <ul class="sidebar-nav">
                <li><a href="stack-tecnologico.html"><i class="fas fa-code"></i> Stack Tecnológico</a></li>
                <li><a href="banco-de-dados.html"><i class="fas fa-database"></i> Banco de Dados</a></li>
                <li><a href="apis-endpoints.html"><i class="fas fa-plug"></i> APIs</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Desenvolvimento</div>
            <ul class="sidebar-nav">
                <li><a href="pipeline-ia.html"><i class="fas fa-brain"></i> Pipeline IA</a></li>
                <li><a href="implementacao.html"><i class="fas fa-hammer"></i> Implementação</a></li>
                <li><a href="seguranca.html"><i class="fas fa-shield-alt"></i> Segurança</a></li>
            </ul>
        </div>
        <div class="sidebar-section">
            <div class="sidebar-title">Deploy</div>
            <ul class="sidebar-nav">
                <li><a href="devops.html"><i class="fas fa-server"></i> DevOps</a></li>
                <li><a href="testes.html"><i class="fas fa-vial"></i> Testes</a></li>
                <li><a href="guia-desenvolvimento.html"><i class="fas fa-road"></i> Guia</a></li>
            </ul>
        </div>
    </nav>

    <main class="main-content">
        <div class="breadcrumb">
            <a href="index.html">Início</a> <i class="fas fa-chevron-right"></i> Arquitetura de Software
        </div>

        <h1>Arquitetura de Software</h1>

        <!-- Arquitetura de Alto Nível -->
        <h2><i class="fas fa-project-diagram"></i> Arquitetura de Alto Nível</h2>

        <div class="card">
            <div class="card-header">
                <i class="fas fa-sitemap"></i>
                <h3>Diagrama Geral do Sistema</h3>
            </div>
            <div class="architecture">
<pre>
┌─────────────────────────────────────────────────────────────┐
│                      CLIENTE (Mobile)                        │
│  ┌─────────────┐  ┌──────────────┐  ┌──────────────────┐   │
│  │ React Native │  │ Redux/Zustand│  │ React Query      │   │
│  │ + Expo       │  │ (State Mgmt) │  │ (Data Fetching)  │   │
│  └─────────────┘  └──────────────┘  └──────────────────┘   │
└────────────────────────────┬────────────────────────────────┘
                             │
                    ┌────────▼────────┐
                    │   API Gateway   │
                    │   (NGINX)       │
                    └────────┬────────┘
                             │
        ┏────────────────────┼────────────────────┓
        ▼                    ▼                    ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│   Auth API    │   │   Core API    │   │  Media API    │
│   (Node.js)   │   │   (Node.js)   │   │  (Node.js)    │
└───────┬───────┘   └───────┬───────┘   └───────┬───────┘
        │                   │                    │
        └───────────────────┼────────────────────┘
                            │
        ┏───────────────────┼───────────────────┓
        ▼                   ▼                   ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│  PostgreSQL   │   │     Redis     │   │   MinIO/S3    │
│  (Primary DB) │   │    (Cache)    │   │ (Object Store)│
└───────────────┘   └───────────────┘   └───────────────┘
                            │
        ┏───────────────────┼───────────────────┓
        ▼                   ▼                   ▼
┌───────────────┐   ┌───────────────┐   ┌───────────────┐
│ AI Pipeline   │   │  Transcription│   │   Speaker     │
│ (Python)      │   │   (Whisper)   │   │ Diarization   │
│  FastAPI      │   │   OpenAI API  │   │  (pyannote)   │
└───────────────┘   └───────────────┘   └───────────────┘
</pre>
            </div>
        </div>

        <!-- Componentes Principais -->
        <h2><i class="fas fa-cubes"></i> Componentes Principais</h2>

        <div class="card">
            <div class="card-header">
                <i class="fas fa-layer-group"></i>
                <h3>Visão dos Componentes</h3>
            </div>

            <h4>1. Frontend (Mobile)</h4>
            <ul>
                <li><strong>React Native + Expo</strong> - Framework principal para desenvolvimento mobile multiplataforma</li>
                <li><strong>Redux/Zustand</strong> - Gerenciamento de estado global da aplicação</li>
                <li><strong>React Query</strong> - Gerenciamento de dados assíncronos, cache e sincronização com o servidor</li>
                <li><strong>expo-av</strong> - Módulo para captura e reprodução de áudio</li>
            </ul>

            <h4>2. Backend (APIs)</h4>
            <ul>
                <li><strong>Node.js + Express</strong> - Runtime e framework HTTP para os serviços de API</li>
                <li><strong>TypeScript</strong> - Tipagem estática para maior segurança e produtividade no código</li>
                <li><strong>Prisma ORM</strong> - Mapeamento objeto-relacional para acesso ao banco de dados</li>
                <li><strong>JWT (JSON Web Tokens)</strong> - Autenticação e autorização stateless</li>
                <li><strong>Bull Queue</strong> - Gerenciamento de filas para processamento assíncrono de tarefas</li>
            </ul>

            <h4>3. Banco de Dados</h4>
            <ul>
                <li><strong>PostgreSQL</strong> - Banco de dados relacional primário para dados estruturados</li>
                <li><strong>Redis</strong> - Cache em memória para sessões, filas e dados temporários</li>
                <li><strong>MinIO/S3</strong> - Armazenamento de objetos para arquivos de áudio e mídia</li>
            </ul>

            <h4>4. IA e Processamento</h4>
            <ul>
                <li><strong>OpenAI Whisper</strong> - Transcrição de áudio para texto com alta precisão</li>
                <li><strong>pyannote.audio</strong> - Diarização de locutores para identificação de quem fala</li>
                <li><strong>GPT-4</strong> - Geração de resumos, extração de tópicos e análise semântica</li>
                <li><strong>Python FastAPI</strong> - Microserviço dedicado ao pipeline de processamento de IA</li>
            </ul>
        </div>

        <!-- Padrões Arquiteturais -->
        <h2><i class="fas fa-drafting-compass"></i> Padrões Arquiteturais</h2>

        <div class="card">
            <div class="card-header">
                <i class="fas fa-shapes"></i>
                <h3>Padrões Utilizados</h3>
            </div>
            <ul>
                <li><strong>Layered Architecture</strong> - Separação em camadas (Presentation, Business, Data Access) para isolamento de responsabilidades</li>
                <li><strong>Clean Architecture</strong> - Independência de frameworks e testabilidade com inversão de dependências</li>
                <li><strong>Repository Pattern</strong> - Abstração do acesso a dados, desacoplando lógica de negócio do banco de dados</li>
                <li><strong>Service Layer</strong> - Camada de serviços encapsulando regras de negócio e orquestração de operações</li>
                <li><strong>Factory Pattern</strong> - Criação de objetos complexos de forma centralizada e configurável</li>
                <li><strong>Observer Pattern</strong> - Comunicação baseada em eventos entre componentes desacoplados</li>
                <li><strong>Dependency Injection</strong> - Injeção de dependências para facilitar testes e manutenção</li>
            </ul>
        </div>

        <!-- Error Handling Strategy -->
        <h2><i class="fas fa-exclamation-triangle"></i> Error Handling Strategy</h2>

        <div class="card">
            <div class="card-header">
                <i class="fas fa-bug"></i>
                <h3>Estratégia de Tratamento de Erros</h3>
            </div>
            <p>O sistema utiliza uma classe centralizada de erros (<code>AppError</code>) combinada com um middleware global de tratamento. Isso garante respostas consistentes e rastreabilidade de falhas em toda a aplicação.</p>
            <pre><code class="language-typescript">export class AppError extends Error {
  constructor(
    public message: string,
    public statusCode: number = 500,
    public code?: string
  ) {
    super(message);
    this.name = 'AppError';
  }
}

// Global error handler middleware
export const errorHandler = (err: Error, req: Request, res: Response, next: NextFunction) =&gt; {
  if (err instanceof AppError) {
    return res.status(err.statusCode).json({
      status: 'error',
      message: err.message,
      code: err.code,
    });
  }

  logger.error('Unhandled error:', err);
  res.status(500).json({
    status: 'error',
    message: 'Internal server error',
  });
};</code></pre>
        </div>

        <!-- Logging Strategy -->
        <h2><i class="fas fa-scroll"></i> Logging Strategy</h2>

        <div class="card">
            <div class="card-header">
                <i class="fas fa-file-alt"></i>
                <h3>Estratégia de Logging</h3>
            </div>
            <ul>
                <li><strong>Winston</strong> - Logging estruturado com suporte a múltiplos transports (console, arquivo, serviço remoto)</li>
                <li><strong>Morgan</strong> - Logging de requisições HTTP com formatação customizada para monitoramento de tráfego</li>
                <li><strong>ELK Stack</strong> - Agregação centralizada de logs com Elasticsearch, Logstash e Kibana para análise e visualização</li>
                <li><strong>Log Levels</strong> - Níveis hierárquicos de severidade: <code>error</code>, <code>warn</code>, <code>info</code>, <code>debug</code></li>
            </ul>
        </div>

        <div class="nav-buttons">
            <a href="design-system.html" class="nav-button prev"><i class="fas fa-arrow-left"></i> Design</a>
            <a href="stack-tecnologico.html" class="nav-button"><span>Stack</span> <i class="fas fa-arrow-right"></i></a>
        </div>

        <footer class="footer">
            <p><strong>Smart Noter v1.0</strong> | <a href="index.html">Início</a> | <a href="#top">Topo ↑</a></p>
        </footer>
    </main>

    <div class="scroll-top" id="scrollTop"><i class="fas fa-arrow-up"></i></div>

    <script>
        hljs.highlightAll();
        const btn = document.getElementById('scrollTop');
        window.addEventListener('scroll', () => btn.classList.toggle('visible', window.pageYOffset > 300));
        btn.addEventListener('click', () => window.scrollTo({top:0,behavior:'smooth'}));
    </script>
</body>
</html>
